{
 "add_total_row": 0,
 "columns": [],
 "creation": "2025-04-09 11:41:55.745748",
 "disabled": 0,
 "docstatus": 0,
 "doctype": "Report",
 "filters": [],
 "idx": 2,
 "is_standard": "Yes",
 "letter_head": "Inform\u00e1tica Municipalidad de Rosario",
 "letterhead": null,
 "modified": "2025-04-23 11:40:20.021381",
 "modified_by": "Administrator",
 "module": "IMUSA",
 "name": "Porcentaje de atenciones de cada tipo por mes",
 "owner": "eli.feuli37@gmail.com",
 "prepared_report": 0,
 "query": "SELECT \r\n    CONCAT(mes_data.mes, ' - ', mes_data.tipo) AS mes_tipo,\r\n    mes_data.cantidad,\r\n    (mes_data.cantidad / total_data.total_atenciones) * 100 AS porcentaje\r\nFROM (\r\n    SELECT \r\n        CASE \r\n            WHEN a.egreso IS NULL THEN 'En proceso'\r\n            ELSE DATE_FORMAT(a.egreso, '%%Y-%%m')\r\n        END AS mes,\r\n        a.tipo,\r\n        COUNT(*) AS cantidad\r\n    FROM \r\n        tabAtencion AS a\r\n    JOIN \r\n        tabAnimal AS an ON a.parent = an.name\r\n    GROUP BY \r\n        CASE \r\n            WHEN a.egreso IS NULL THEN 'En proceso'\r\n            ELSE DATE_FORMAT(a.egreso, '%%Y-%%m')\r\n        END,\r\n        a.tipo\r\n) AS mes_data\r\nINNER JOIN (\r\n    SELECT \r\n        CASE \r\n            WHEN a.egreso IS NULL THEN 'En proceso'\r\n            ELSE DATE_FORMAT(a.egreso, '%%Y-%%m')\r\n        END AS mes,\r\n        COUNT(*) AS total_atenciones\r\n    FROM \r\n        tabAtencion AS a\r\n    JOIN \r\n        tabAnimal AS ani ON a.parent = ani.name\r\n    GROUP BY \r\n        CASE \r\n            WHEN a.egreso IS NULL THEN 'En proceso'\r\n            ELSE DATE_FORMAT(a.egreso, '%%Y-%%m')\r\n        END\r\n) AS total_data\r\nON mes_data.mes = total_data.mes\r\nORDER BY \r\n    (mes_data.mes = 'En proceso') DESC,  \r\n    mes_data.mes ASC,\r\n    mes_data.cantidad DESC;\r\n\r\n\r\n",
 "ref_doctype": "Animal",
 "report_name": "Porcentaje de atenciones de cada tipo por mes",
 "report_type": "Query Report",
 "roles": [
  {
   "role": "System Manager"
  },
  {
   "role": "Veterinario"
  },
  {
   "role": "Creador"
  }
 ],
 "timeout": 0
}
